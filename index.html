<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="keywords" content="数学, 計算問題, 展開, 因数分解, 足し算, 引き算, 掛け算, 割り算, √, 数式, 教育, 学習">

        <title>
            keisann
        </title>
        <link rel="icon" href="icon/favicon.png?v=2">
        <link rel="apple-touch-icon" href="icon/favicon.png?v=2">
        <style>
           html{
            text-align: center;
            font-family: sans-serif;
            font-size: 30px;
           } 
           #ans{
            height:35px ;
            border: 3px solid #eee;
            border-radius: 5px;
           }
           #iti, #ni, #san, #tasu, #rui, #root, #yon, #go, #roku, #hiku, #kakkomigi, #kakkomigi2, #nana, #hati, #kyuu, #kakeru, #kakkohidari, #kakkohidari2, #x, #zero, #y, #waru, #iko-ru, #ok {
            width: 50px; /* 幅を統一 */
            height: 50px; /* 高さを統一 */
            background-color: #ddd; /* 背景色 */
            text-align: center; /* テキスト中央揃え */
            border: 3px solid #999;
            border-radius: 10px;
            font-family: sans-serif;
            font-size: 20px;
            }
            #iti:active, #ni:active, #san:active, #tasu:active, #rui:active, #root:active, #yon:active, #go:active, #roku:active, #hiku:active, #kakkomigi:active, #kakkomigi2:active, #nana:active, #hati:active, #kyuu:active, #kakeru:active, #kakkohidari:active, #kakkohidari2:active, #x:active, #zero:active, #y:active, #waru:active, #iko-ru:active, #ok:active{
            width: 50px; /* 幅を統一 */
            height: 50px; /* 高さを統一 */
            background-color: #999; /* 背景色 */
            text-align: center; /* テキスト中央揃え */
            border: 3px solid #555;
            border-radius: 10px;
            font-family: sans-serif;
            font-size: 20px;
            }
            #delete{
            width: 150px; /* 幅を統一 */
            height: 50px; /* 高さを統一 */
            background-color: #ddd; /* 背景色 */
            text-align: center; /* テキスト中央揃え */
            border: 3px solid #999;
            border-radius: 10px;
            font-family: sans-serif;
            font-size: 20px;
            }
            #delete:active{
            width: 150px; /* 幅を統一 */
            height: 50px; /* 高さを統一 */
            background-color: #999; /* 背景色 */
            text-align: center; /* テキスト中央揃え */
            border: 3px solid #555;
            border-radius: 10px;
            font-family: sans-serif;
            font-size: 20px;
            }
            #num{
                display: flex;
                flex-wrap: wrap; /* 自動で折り返す */
                justify-content: center; /* 中央揃え */
                gap: 5px; /* ボタン間の余白 */
                width: 400px;
                margin: auto; /* 左右中央揃え */
            }
        </style>
    </head>
    <body>
        <div id="Question">
            範囲を指定したら’ok’を押してください！
        </div>
        <div id="ans">
        </div>
        <select name="syurui" id="syurui">
            <option value="tennkai">展開</option>
            <option value="innsuubunnkai">因数分解</option>
            <option value="nizihouteisiki">二次方程式</option>
            <option value="tasizann">足し算</option>
            <option value="hikizann">引き算</option>
            <option value="kakezann">掛け算</option>
            <option value="warizann">割り算</option>
            <option value="shisokuennzann">四則演算</option>
        </select>
        <div id="num"><p id="light">＞</p><p id="atai">１</p><p id="left">＜</p></body></div>
        <div id="num">
            <div id="iti">1</div><div id="ni">2</div><div id="san">3</div><div id="tasu">+</div><div id="rui">^</div><div id="root">√</div><br>
            <div id="yon">4</div><div id="go">5</div><div id="roku">6</div><div id="hiku">-</div><div id="kakkomigi">(</div><div id="kakkomigi2">{</div><br>
            <div id="nana">7</div><div id="hati">8</div><div id="kyuu">9</div><div id="kakeru">×</div><div id="kakkohidari">)</div><div id="kakkohidari2">}</div><br>
            <div id="x">x</div><div id="zero">0</div><div id="y">y</div><div id="waru">÷</div><div id="iko-ru">=</div><div id="ok">ok</div><br>
            <div id="delete">delete</div>
        </div>
        <script>
            'use strict'
            let num = 1
            let _question = 0
            let rui = 0
            let ans = ''
            let ans1 = ''
            let ans2 = ''
            let syurui = document.getElementById("syurui").value;
            let list = ''
            let numb = 0
            let i = 0
            let ranndamu = 0
            function innsuubunnkai () {
                let random = Math.floor(Math.random()*3+1)
                let a = Math.floor(Math.random()*num+1)
                let b = Math.floor(Math.random()*num+1)
                let kigou = Math.floor(Math.random()*4+1)
                let c = 0
                let d = 0
                if (a === b) {
                    b +=1
                }
                if (random === 1)  {
                    if (kigou === 2){
                        a = a*-1
                    }
                    if (kigou === 3){
                        b = b*-1
                    }
                    if (kigou === 4){
                        a = a*-1
                        b = b*-1
                    }
                    c = a+b
                    d = a*b
                    if (a > -1){
                        a = '+'+a
                    }
                    if (b > -1){
                        b = '+'+b
                    }
                    if (c > -1){
                        c = '+'+c
                    }
                    if (d > -1){
                        d = '+'+d
                    }
                    _question = 'x²'+c+'x'+d
                    ans1 ='(x'+a+')(x'+b+')'
                    ans2 ='(x'+b+')(x'+a+')'
                }
                if (random === 2)  {
                    if (kigou === 2){
                        a = a*-1
                    }
                    c = a*2
                    d = a*a
                    if (a > -1){
                        a = '+'+a
                    }
                    if (c > -1){
                        c = '+'+c
                    }
                    d = '+'+d
                    _question = 'x²'+c+'x'+d
                    ans1 ='(x'+a+')²'
                }
                if (random === 3)  {
                    c = a*a
                    c = '-'+c
                    _question = 'x²'+c
                    ans1 ='(x+'+a+')(x-'+a+')'
                    ans2 ='(x-'+a+')(x+'+a+')'
                }
            }
            function tennkai () {
                let random = Math.floor(Math.random()*3+1)
                let a = Math.floor(Math.random()*num+1)
                let b = Math.floor(Math.random()*num+1)
                let kigou = Math.floor(Math.random()*4+1)
                let c = 0
                let d = 0
                if (a === b) {
                    b +=1
                }
                if (random === 1)  {
                    if (kigou === 2){
                        a = a*-1
                    }
                    if (kigou === 3){
                        b = b*-1
                    }
                    if (kigou === 4){
                        a = a*-1
                        b = b*-1
                    }
                    c = a+b
                    d = a*b
                    if (a > -1){
                        a = '+'+a
                    }
                    if (b > -1){
                        b = '+'+b
                    }
                    if (c > -1){
                        c = '+'+c
                    }
                    if (d > -1){
                        d = '+'+d
                    }
                    _question = '(x'+a+')(x'+b+')'
                    ans1 ='x²'+c+'x'+d
                    ans2 ='な市'
                }
                if (random === 2)  {
                    if (kigou === 2){
                        a = a*-1
                    }
                    c = a*2
                    d = a*a
                    if (a > -1){
                        a = '+'+a
                    }
                    if (c > -1){
                        c = '+'+c
                    }
                    d = '+'+d
                    _question = '(x'+a+')²'
                    ans1 ='x²'+c+'x'+d
                }
                if (random === 3)  {
                    c = a*a
                    c = '-'+c
                    _question = '(x+'+a+')(x-'+a+')'
                    ans1 ='x²'+c
                    ans2 ='なし'
                }
            }
            function tasizann () {
                let a = Math.floor(Math.random()*num+1)
                let b = Math.floor(Math.random()*num+1)
                ans1 = String(a + b)
                ans2 = 'nasi'
                _question = a+'+'+b
            }
            function hikizann () {
                let a = Math.floor(Math.random()*num+1)
                let b = Math.floor(Math.random()*num+1)
                ans1 = String(a - b)
                ans2 = 'nasi'
                _question = a+'-'+b
            }
            function kakezann () {
                let a = Math.floor(Math.random()*num+1)
                let b = Math.floor(Math.random()*num+1)
                ans1 = String(a * b)
                ans2 = 'nasi'
                _question = a+'×'+b
            }
            function warizann () {
                ans1 = Math.floor(Math.random()*num+1)
                let b = Math.floor(Math.random()*num+1)
                let a = ans1 * b
                ans1 = String(ans1)
                ans2 = 'nasi'
                _question = a+'÷'+b
            }
            function soinnsuubunnkai (i) {
                let I = 2
                let sosuu = []
                let I2 =1
                while (I < i) {
                    I2 =1
                    sosuu.push(I)
                    while (sosuu.length > I2) {
                        if (Number.isInteger(I / sosuu[I2-1]) === true ){
                            sosuu.pop()
                            break
                        }
                        I2 += 1
                    }
                    I +=1
                }
                let result = [];
                let n = i;
                let index = 0;

                while (n > 1 && index < sosuu.length) {
                    let p = sosuu[index];
                    if (n % p === 0) {
                        result.push(p)
                        n = n / p;
                    } else {
                        index++;
                    }
                }
                return result;
            }
            function nizihouteisiki () {
                let a = Math.floor(Math.random()*num+1)
                let b = Math.floor(Math.random()*num+1)
                let c = Math.floor(Math.random()*num+1)
                if (a === 0) {
                    a = -1
                }
                let b2 = b*-1
                let b24ac = b*b+4*a*c*-1
                let kari = b24ac + 1
                let kekka = soinnsuubunnkai(b24ac)
                let i = 1
                let sumple = kekka[0]
                let kazu_kind =[kekka[0]]
                let kazu =[]
                let now_kazu = 0
                while (kekka.length >= i) {
                    if (kekka[i-1] === sumple){
                        now_kazu +=1
                    } else {
                        kazu.push(now_kazu) 
                        kazu_kind.push(kekka[i-1])
                        now_kazu = 1
                    }
                    sumple = kekka[i-1]
                    i+=1
                }
                let root_out = 1
                let root_in = 1
                i = 0
                while (kazu.length > i) {
                    
                    if (kazu[i] % 2 === 0) {
                        root_out = root_out * kazu_kind[i]**(kazu[i]/2)
                    } else if (kazu[i] === 1){
                        root_in = root_in * kazu_kind[i]
                    } else {
                        root_out = root_out * kazu_kind[i]**((kazu[i]-1)/2)
                        root_in = root_in * kazu_kind[i]
                    }
                    i++
                }
                let bunnbo = soinnsuubunnkai(2*a)
                i = 1
                sumple = bunnbo[0]
                kazu_kind =[bunnbo[0]]
                kazu =[]
                now_kazu = 0
                while (bunnbo.length >= i) {
                    if (bunnbo[i-1] === sumple){
                        now_kazu +=1
                    } else {
                        kazu.push(now_kazu) 
                        kazu_kind.push(bunnbo[i-1])
                        now_kazu = 1
                    }
                    sumple = bunnbo[i-1]
                    i+=1
                }
                let bunnsi1 = soinnsuubunnkai(b2)
                i = 1
                sumple = bunnsi1[0]
                let bun1_kind =[bunnsi1[0]]
                let bun1kazu =[]
                now_kazu = 0
                while (bunnsi1.length >= i) {
                    if (bunnsi1[i-1] === sumple){
                        now_kazu +=1
                    } else {
                        bun1kazu.push(now_kazu) 
                        bun1_kind.push(bunnsi1[i-1])
                        now_kazu = 1
                    }
                    sumple = bunnsi1[i-1]
                    i+=1
                }
                let bunnsi2 = soinnsuubunnkai(b2)
                i = 1
                sumple = bunnsi2[0]
                let bun2_kind =[bunnsi1[0]]
                let bun2kazu =[]
                now_kazu = 0
                while (bunnsi2.length >= i) {
                    if (bunnsi2[i-1] === sumple){
                        now_kazu +=1
                    } else {
                        bun2kazu.push(now_kazu) 
                        bun2_kind.push(bunnsi2[i-1])
                        now_kazu = 1
                    }
                    sumple = bunnsi2[i-1]
                    i+=1
                }
                i = 0
                now_kazu = 0
                let bun1 = []
                let bun1_num = []
                while (i < bun1kazu.length || now_kazu < kazu_kind.length) {
                    if (bun1_kind[i]===kazu_kind[now_kazu]) {
                        bun1.push(bun1_kind[i])
                        bun1_num.push(bun1kazu[i])
                        now_kazu++
                        i++
                    } else if (bun1_kind[i]>kazu_kind[now_kazu]) {
                        bun1.push(kazu_kind[now_kazu])
                        bun1_num.push(0)
                        now_kazu++
                    }else {
                        i++
                    }
                }
                i = 0
                now_kazu = 0
                let bun2 = []
                let bun2_num = []
                while (i < bun2kazu.length || now_kazu < kazu_kind.length) {
                    if (bun2_kind[i]===kazu_kind[now_kazu]) {
                        bun2.push(bun2_kind[i])
                        bun2_num.push(bun2kazu[i])
                        now_kazu++
                        i++
                    } else if (bun2_kind[i]>kazu_kind[now_kazu]) {
                        bun2.push(kazu_kind[now_kazu])
                        bun2_num.push(0)
                        now_kazu++
                    }else {
                        i++
                    }
                }
                i=0
                let waru =1
                while (i<kazu_kind.length){
                    if(bun1_num[i] >= kazu[i] && bun2_num[i] >= kazu[i]){
                        waru = waru*kazu_kind[i]**kazu[i]
                    }else if (bun1_num[i] !==0 || bun2_num[i] !==0){
                        if(bun1_num[i] < bun2_num[i]){
                            waru =waru*bun1[i]**bun1_num[i]
                        }else{
                            waru=waru*bun2[i]**bun2_num[i]
                        }
                    }
                    i++
                }
                root_out = root_out/waru
                b2 = b2/waru
                let bunnbo2 = a*2/waru
                let root =0
                if (root_in === 1){
                    root =1
                }
                let bun =0
                if (bunnbo2===1){
                    bun =2
                }
                switch (root + bun) {
                    case 1:
                        ans1 = (b2+root_out)+'/'+bunnbo2+','+(b2-root_out)+'/'+bunnbo2
                        ans2 = (b2-root_out)+'/'+bunnbo2+','+(b2+root_out)+'/'+bunnbo2
                        break;
                    case 2:
                        ans1 = b2+'±'+root_out+'√'+root_in
                        ans2 ='nasi'
                        break;

                    case 3:
                        ans1 = b2+root_out+','+b2-root_out
                        ans2 = b2-root_out+','+b2+root_out
                        break;
                    case 0:
                        ans1 = b2+'±'+root_out+'√'+root_in+'/'+bunnbo2
                        ans2 ='nasi'
                        break;
                
                    default:
                        break;
                }
                _question = a+'x²+'+b+'x+'+c+'=0'
            }
            document.getElementById('light').onclick = function() {
                num +=1
                document.getElementById('atai').textContent = num
            }
            document.getElementById('left').onclick = function() {
                num -=1
                document.getElementById('atai').textContent = num
            }
            document.getElementById('rui').onclick = function() {
                if (rui < 1) {
                     rui = 1
                     document.getElementById('ok').textContent = '^end'
                }
            }
            document.getElementById('iti').onclick = function() {
                if (rui < 1) {
                    ans = ans + '1'
                } else {
                    ans = ans + '¹'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('ni').onclick = function() {
                if (rui < 1) {
                    ans = ans + '2'
                } else {
                    ans = ans + '²'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('san').onclick = function() {
                if (rui < 1) {
                    ans = ans + '3'
                } else {
                    ans = ans + '³'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('yon').onclick = function() {
                if (rui < 1) {
                    ans = ans + '4'
                } else {
                    ans = ans + '⁴'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('go').onclick = function() {
                if (rui < 1) {
                    ans = ans + '5'
                } else {
                    ans = ans + '⁵'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('roku').onclick = function() {
                if (rui < 1) {
                    ans = ans + '6'
                } else {
                    ans = ans + '⁶'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('nana').onclick = function() {
                if (rui < 1) {
                    ans = ans + '7'
                } else {
                    ans = ans + '⁷'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('hati').onclick = function() {
                if (rui < 1) {
                    ans = ans + '8'
                } else {
                    ans = ans + '⁸'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('kyuu').onclick = function() {
                if (rui < 1) {
                    ans = ans + '9'
                } else {
                    ans = ans + '⁹'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('zero').onclick = function() {
                if (rui < 1) {
                    ans = ans + '0'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('x').onclick = function() {
                if (rui < 1) {
                    ans = ans + 'x'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('y').onclick = function() {
                if (rui < 1) {
                    ans = ans + 'y'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('tasu').onclick = function() {
                if (rui < 1) {
                    ans = ans + '+'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('hiku').onclick = function() {
                if (rui < 1) {
                    ans = ans + '-'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('kakeru').onclick = function() {
                if (rui < 1) {
                    ans = ans + '×'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('waru').onclick = function() {
                if (rui < 1) {
                    ans = ans + '÷'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('kakkomigi').onclick = function() {
                if (rui < 1) {
                    ans = ans + '('
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('kakkomigi2').onclick = function() {
                if (rui < 1) {
                    ans = ans + '{'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('kakkohidari').onclick = function() {
                if (rui < 1) {
                    ans = ans + ')'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('kakkohidari2').onclick = function() {
                if (rui < 1) {
                    ans = ans + '}'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('iko-ru').onclick = function() {
                if (rui < 1) {
                    ans = ans + '='
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('root').onclick = function() {
                if (rui < 1) {
                    ans = ans + '√'
                }
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('delete').onclick = function() {
                numb = ans.length
                i = 1
                list = ''
                while (i < numb){
                    list = list + ans[i - 1]
                    i += 1
                }
                ans = list
                document.getElementById('ans').textContent = ans
            }
            document.getElementById('ok').onclick = function() {
                if (rui < 1) {
                    if (ans1 === ans) {
                        document.getElementById('ans').textContent = "正解"
                    }else if (ans2 === ans){
                        document.getElementById('ans').textContent = "正解"
                    }else {
                        document.getElementById('ans').textContent = "不正解 答え；"+ans1
                    }
                    ans = ''
                    syurui = document.getElementById("syurui").value;
                    if (syurui === "innsuubunnkai"){
                        innsuubunnkai()
                        document.getElementById('Question').textContent = _question
                    }
                    if (syurui === 'tennkai'){
                        tennkai()
                        document.getElementById('Question').textContent = _question
                    }
                    if (syurui === 'tasizann'){
                        tasizann()
                        document.getElementById('Question').textContent = _question
                    }
                    if (syurui === 'hikizann'){
                         hikizann()
                        document.getElementById('Question').textContent = _question
                    }
                    if (syurui === 'kakezann'){
                         kakezann()
                        document.getElementById('Question').textContent = _question
                    }
                    if (syurui === 'warizann'){
                         warizann()
                        document.getElementById('Question').textContent = _question
                    }
                    if (syurui === 'shisokuennzann'){
                        ranndamu = Math.floor(Math.random()*4+1)
                         switch (ranndamu) {
                            case 1:
                               tasizann() 
                                break;
                            case 2:
                                hikizann()
                                break;
                            case 3:
                                kakezann()
                                break;
                            case 4:
                                warizann()
                                break;
                            default:
                                break;
                         }
                        document.getElementById('Question').textContent = _question
                    }
                    if (syurui === 'nizihouteisiki'){
                         nizihouteisiki()
                        document.getElementById('Question').textContent = _question
                    }
                } else {
                    rui = 0
                    document.getElementById('ok').textContent = 'ok'
                }
            }
        </script>
    </body>
</html>